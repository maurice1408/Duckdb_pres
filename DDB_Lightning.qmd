---
title: "DuckDB"
subtitle: "A fast in-process analytical database / data engineering workhorse"
author: Maurice Hickey
format: 
  revealjs:
    theme: moon
    chalkboard: false
    drop:
        engine: pyodide
        pyodide:
          packages:
            - duckdb
            - pandas
date: today
date-format: long
transition: convex
code-line-numbers: true
embed-resources: true
logo: './ddb.png'
auto-stretch: false
progress: true
keyboard: true
---

# Introduction

# Me

## Raised

::: columns
::: {.column width="33%"}
![](angel.jpeg)
:::

::: {.column width="33%"}
![](tb.jpg)
:::

::: {.column width="33%"}
```{r}
#| echo: false
#| fig-height: 5
library(leaflet)
leaflet(width=300, height=300) %>%
  addTiles() %>%  # Add default OpenStreetMap map tiles
  setView(-1.614, 54.973, zoom=11) %>%
  addMarkers(lng=-1.614, lat=54.973, popup="Newcastle upon Tyne")
```
:::
:::

## Studied

::: columns
::: {.column width="33%"}
![](rhc4.jpeg)
:::

::: {.column width="33%"}
![](founders2.jpeg)
:::

::: {.column width="33%"}
```{r}
#| echo: false
#| fig-height: 5
library(leaflet)
leaflet(width=300, height=300) %>%
  addTiles() %>%  # Add default OpenStreetMap map tiles
  setView(-0.55239, 51.43188, zoom=9) %>%
  addMarkers(lng=-0.55239, lat=51.43188, popup="Royal Holloway College, Uni of London")
```
:::
:::

::: columns
::: {.column width="33%"}
![](pdp8.jpg)
:::
:::

::: notes
Word size	12 bits
Maximum memory	32k words (8 4k banks)


Power	<= 450 watts (varies with option cards)
Size (HeightxWidthxDepth) 	10.5x19x24 inches
Weight	100 lbs total, 45 lbs power supply
Cost Minimum Configuration 4k memory	$4490 installation included from DEC in 1974
  $53 per month for maintenance
Cost in configuration shown, excluding I/O devices
and third party boards	$14835 from DEC in 1974
  $134 per month for maintenance
:::

## Based

::: columns
::: {.column width="33%"}
![](16533130012318.jpeg)
:::

::: {.column width="33%"}
![](bristol1.jpg)
:::

::: {.column width="33%"}
```{r}
#| echo: false
#| fig-height: 5
library(leaflet)
leaflet(width=300, height=300) %>%
  addTiles() %>%  # Add default OpenStreetMap map tiles
  setView(-2.59665, 51.45523, zoom=9) %>%
  addMarkers(lng=-2.59665, lat=51.45523, popup="Clockwise, Bristol")
```
:::
:::

::: columns
::: {.column width="50%"}
![](third_floor.jpg)
:::

::: {.column width="50%"}
:::
:::

# My Workflow

## Pandion Data Engineering

```{mermaid}
flowchart LR
  A[".txt / .csv / .tsv
    json / XML / PDF"] --> ETL(ETL)
  B[("MySQL / Oracle /
  MongoDB")] --> ETL
  C[Excel / Docx] --> ETL
  D[png / jpg] --> ETL
  E[a.n.other] --> ETL 
  ETL -- Ingest --> G[Snowflake]
  ETL -- Delivery --> H[Meta]
```

## Daily Tools

::: incremental
-   sed / awk / vim(!)
-   xsv / Miller / jq
-   Python / Pandas
-   Misc. - od / ripgrep / iconv / parallel / cut / sort / pandoc
:::

::: footer
One million developers ask how to exit vim! [Exiting Vim](https://stackoverflow.blog/2017/05/23/stack-overflow-helping-one-million-developers-exit-vim/){preview-link="true"}
:::

# DuckDB

## DuckDB Adoption - August 2024

::: callout-note
Jan 2024 numbers in ()
:::

::: incremental
-   Python Client, 6 million + downloads per month (2m)
-   17 million extension installs / month (5m)
-   21,000 Github stars (15.5k)
-   DB-Engines relational db ranking 35th (43rd)
-   600k unique visitors to duckdb.org / month (500k)

:::

## DuckDB - What is it?

::: columns

::: {.column width="50%"}

::: incremental
-   Lightweight
-   Embedded / In process
-   Complete SQL Implementation
-   Well suited for OLAP
-   Brilliant as a Data Engineering pipeline component
:::

::: {.fragment .fade-in}
and ...

It's fast. ğŸ’¨ğŸ’¨ğŸ’¨
:::

:::

::: {.column width="50%"}
![](db_space.jpeg)
:::
:::

::: footer
[Kojo's Blog](https://kojo.blog/duckdb){preview-link="true"}
:::


## Installation

``` bash
brew install duckdb  â†©
```

The `duckdb` executable

1.  Has no dependencies
2.  Is *small*

``` {.bashc code-line-numbers="1|2"}
exa -l (which duckdb) â†©
.rwxr-xr-x 49M root 10 Sep 10:04 /usr/local/bin/duckdb
```

## DuckDB CLI

Once installed ...

``` {.bash code-line-numbers="1|8-10"}
duckdb â†©

v1.0.0 1f98600c2c
Enter ".help" for usage hints.
Connected to a transient in-memory database.
Use ".open FILENAME" to reopen on a persistent database.
âš«â——
âš«â—— create or replace table ducks (id int, duck_name varchar);  â†©
âš«â—— insert into ducks values (1, 'mulard'), (2, 'welsh harlequin');  â†©
âš«â—— from ducks;  â†©
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  id   â”‚    duck_name    â”‚
â”‚ int32 â”‚     varchar     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     1 â”‚ mulard          â”‚
â”‚     2 â”‚ welsh harlequin â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
âš«â——
```

## Persisting data

``` {.bash code-line-numbers="1|5-7|15"}
duckdb ducks.ddb  â†©

v1.0.0 1f98600c2c
Enter ".help" for usage hints.
âš«â—— create or replace table ducks (id int, duck_name varchar);  â†©
âš«â—— insert into ducks values (1, 'mulard'), (2, 'welsh harlequin');  â†©
âš«â—— from ducks;  â†©
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  id   â”‚    duck_name    â”‚
â”‚ int32 â”‚     varchar     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     1 â”‚ mulard          â”‚
â”‚     2 â”‚ welsh harlequin â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
âš«â—— .q  â†©
```

## Persisting data - 2

``` {.bash code-line-numbers="2-3|5|7|10"}

lsd -l ducks.ddb
.rw-r--r-- mauriceh staff 524 KB Wed Mar  6 09:49:34 2024 ï€– ducks.ddb

duckdb ducks.ddb
-- Loading resources from /Users/mauriceh/.duckdbrc
ducks
v1.0.0 1f98600c2c
Enter ".help" for usage hints.
âš«â—— from ducks;
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  id   â”‚    duck_name    â”‚
â”‚ int32 â”‚     varchar     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     1 â”‚ mulard          â”‚
â”‚     2 â”‚ welsh harlequin â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Run Time (s): real 0.002 user 0.000850 sys 0.000469
```

## DuckDB file format

::: incremental
-   Single file db
-   Suppports transactions (ACID)
-   Data stored in compressed columnar format
:::

::: notes
ACID

-   Atomicity
-   Consistent
-   Isolation
-   Durability

All your ducks are not in a row!
:::

## Loading data

Duckdb supports reading data from â‹¯

::: incremental
-   csv / tsv
-   Parquet
-   httpfs
-   S3
-   Google Cloud Storage
-   JSON
-   Excel
-   PostgreSQL / MySQL / SQLite
:::

## Loading data - csv 1

Kaggle Netflix daily top 10 for 2020 `netflix_daily_top_10.csv`

Inspection using the command line

``` {.bash code-line-numbers="1|13"}
xsv headers netflix_daily_top_10.csv â†©
1   As of
2   Rank
3   Year to Date Rank
4   Last Week Rank
5   Title
6   Type
7   Netflix Exclusive
8   Netflix Release Date
9   Days In Top 10
10  Viewership Score

xsv count netflix_daily_top_10.csv  â†©
7100
```

## Loading data - csv 2

Inspection using duckdb

``` {.bash code-line-numbers="1"}
select * from read_csv_auto('./netflix_daily_top_10.csv') limit 5;  â†©
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   As of    â”‚ Rank  â”‚ Year to Date Rank â”‚ Last Week Rank â”‚            Title             â”‚  Type   â”‚ Netflix Exclusive â”‚ Netflix Release Date â”‚ Days In Top 10 â”‚ Viewership Score â”‚
â”‚    date    â”‚ int64 â”‚      varchar      â”‚    varchar     â”‚           varchar            â”‚ varchar â”‚      varchar      â”‚       varchar        â”‚     int64      â”‚      int64       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2020-04-01 â”‚     1 â”‚ 1                 â”‚ 1              â”‚ Tiger King: Murder, Mayhem â€¦ â”‚ TV Show â”‚ Yes               â”‚ Mar 20, 2020         â”‚              9 â”‚               90 â”‚
â”‚ 2020-04-01 â”‚     2 â”‚ 2                 â”‚ -              â”‚ Ozark                        â”‚ TV Show â”‚ Yes               â”‚ Jul 21, 2017         â”‚              5 â”‚               45 â”‚
â”‚ 2020-04-01 â”‚     3 â”‚ 3                 â”‚ 2              â”‚ All American                 â”‚ TV Show â”‚                   â”‚ Mar 28, 2019         â”‚              9 â”‚               76 â”‚
â”‚ 2020-04-01 â”‚     4 â”‚ 4                 â”‚ -              â”‚ Blood Father                 â”‚ Movie   â”‚                   â”‚ Mar 26, 2020         â”‚              5 â”‚               30 â”‚
â”‚ 2020-04-01 â”‚     5 â”‚ 5                 â”‚ 4              â”‚ The Platform                 â”‚ Movie   â”‚ Yes               â”‚ Mar 20, 2020         â”‚              9 â”‚               55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Summarize 

``` {.bash code-line-numbers="2|3-19|20"}

summarize select * from read_csv_auto('./netflix_daily_top_10.csv');  â†©
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     column_name      â”‚ column_type â”‚      min      â”‚     max     â”‚ approx_unique â”‚        avg         â”‚        std         â”‚   q25   â”‚   q50   â”‚   q75   â”‚ count â”‚ null_percentage â”‚
â”‚       varchar        â”‚   varchar   â”‚    varchar    â”‚   varchar   â”‚     int64     â”‚      varchar       â”‚      varchar       â”‚ varchar â”‚ varchar â”‚ varchar â”‚ int64 â”‚  decimal(9,2)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ As of                â”‚ DATE        â”‚ 2020-04-01    â”‚ 2022-03-11  â”‚           694 â”‚                    â”‚                    â”‚         â”‚         â”‚         â”‚  7100 â”‚            0.00 â”‚
â”‚ Rank                 â”‚ BIGINT      â”‚ 1             â”‚ 10          â”‚            10 â”‚ 5.5                â”‚ 2.8724836179710516 â”‚ 3       â”‚ 5       â”‚ 8       â”‚  7100 â”‚            0.00 â”‚
â”‚ Year to Date Rank    â”‚ VARCHAR     â”‚ -             â”‚ 9           â”‚            11 â”‚                    â”‚                    â”‚         â”‚         â”‚         â”‚  7100 â”‚            0.00 â”‚
â”‚ Last Week Rank       â”‚ VARCHAR     â”‚ -             â”‚ 9           â”‚            11 â”‚                    â”‚                    â”‚         â”‚         â”‚         â”‚  7100 â”‚            0.00 â”‚
â”‚ Title                â”‚ VARCHAR     â”‚ #Alive        â”‚ Ãƒlite       â”‚           645 â”‚                    â”‚                    â”‚         â”‚         â”‚         â”‚  7100 â”‚            0.00 â”‚
â”‚ Type                 â”‚ VARCHAR     â”‚ Concert/Perfâ€¦ â”‚ TV Show     â”‚             4 â”‚                    â”‚                    â”‚         â”‚         â”‚         â”‚  7100 â”‚            0.00 â”‚
â”‚ Netflix Exclusive    â”‚ VARCHAR     â”‚ Yes           â”‚ Yes         â”‚             1 â”‚                    â”‚                    â”‚         â”‚         â”‚         â”‚  7100 â”‚           35.23 â”‚
â”‚ Netflix Release Date â”‚ VARCHAR     â”‚ Apr 1, 2015   â”‚ Sep 9, 2020 â”‚           418 â”‚                    â”‚                    â”‚         â”‚         â”‚         â”‚  7100 â”‚            0.00 â”‚
â”‚ Days In Top 10       â”‚ BIGINT      â”‚ 1             â”‚ 428         â”‚           427 â”‚ 24.123661971830987 â”‚ 58.47378925134757  â”‚ 3       â”‚ 7       â”‚ 18      â”‚  7100 â”‚            0.00 â”‚
â”‚ Viewership Score     â”‚ BIGINT      â”‚ 1             â”‚ 1474        â”‚           790 â”‚ 122.79014084507043 â”‚ 213.86164216049585 â”‚ 19      â”‚ 50      â”‚ 128     â”‚  7100 â”‚            0.00 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 10 rows                                                                                                                                                                 12 columns â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Run Time (s): real 0.074 user 0.071562 sys 0.002216
```

## Loading data - csv 3

Persisting the data to DuckDB

``` {.bash code-line-numbers="1|3-5|6|15-18"}
duckdb netflix.ddb â†©

âš«â—— create or replace table netflix as
    from read_csv_auto('./netflix_daily_top_10.csv'); â†©
Run Time (s): real 0.040 user 0.035579 sys 0.002059
âš«â—— select count(*) from netflix;  â†©
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ count_star() â”‚
â”‚    int64     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         7100 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Run Time (s): real 0.003 user 0.000844 sys 0.000793

âš«â—— select title, max("Days In Top 10") m10
    from netflix
    group by all
    order by m10 desc limit 4; â†©
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Title   â”‚  m10  â”‚
â”‚  varchar  â”‚ int64 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Cocomelon â”‚   428 â”‚
â”‚ Ozark     â”‚    89 â”‚
â”‚ Cobra Kai â”‚    81 â”‚
â”‚ Manifest  â”‚    80 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
Run Time (s): real 0.002 user 0.002674 sys 0.000960
```

## Loading data - parquet

``` {.bash code-line-numbers="1|5|7-8|10|12|19"}
lsd -l *parquet â†©
.rw-r--r-- mauriceh staff 90 KB Tue Feb 27 17:38:53 2024 ï€– output.parquet
.rw-r--r-- mauriceh staff 46 MB Tue Feb 27 17:12:32 2024 ï€– yellow_tripdata_2023-01.parquet

duckdb yellow.ddb â†©

âš«â—— create or replace table yellow as
    select * from read_parquet('./yellow_tripdata_2023-01.parquet'); â†©
100% â–•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–
Run Time (s): real 2.224 user 1.990120 sys 0.094305

âš«â—— select count(*) from yellow; â†©
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ count_star() â”‚
â”‚    int64     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      3066766 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Run Time (s): real 0.003 user 0.003078 sys 0.000793
```

## Loading data - parquet 2

Read directly from S3 as 635Mb parquet file

``` {.sql code-line-numbers="2-4|6|8|31|39|60-61|81-85|103"}

create or replace table hackernews as 
select * 
from read_parquet('https://duckdb-md-dataset-121.s3.amazonaws.com/hacker_news/hacker_news_2021.zstd.parquet');
100% â–•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–
Run Time (s): real 12.741 user 9.512807 sys 4.250502

âš«â—— show hackernews;
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ column_name â”‚ column_type â”‚  null   â”‚   key   â”‚ default â”‚ extra â”‚
â”‚   varchar   â”‚   varchar   â”‚ varchar â”‚ varchar â”‚ varchar â”‚ int32 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ title       â”‚ VARCHAR     â”‚ YES     â”‚         â”‚         â”‚       â”‚
â”‚ url         â”‚ VARCHAR     â”‚ YES     â”‚         â”‚         â”‚       â”‚
â”‚ text        â”‚ VARCHAR     â”‚ YES     â”‚         â”‚         â”‚       â”‚
â”‚ dead        â”‚ BOOLEAN     â”‚ YES     â”‚         â”‚         â”‚       â”‚
â”‚ by          â”‚ VARCHAR     â”‚ YES     â”‚         â”‚         â”‚       â”‚
â”‚ score       â”‚ BIGINT      â”‚ YES     â”‚         â”‚         â”‚       â”‚
â”‚ time        â”‚ BIGINT      â”‚ YES     â”‚         â”‚         â”‚       â”‚
â”‚ timestamp   â”‚ TIMESTAMP   â”‚ YES     â”‚         â”‚         â”‚       â”‚
â”‚ type        â”‚ VARCHAR     â”‚ YES     â”‚         â”‚         â”‚       â”‚
â”‚ id          â”‚ BIGINT      â”‚ YES     â”‚         â”‚         â”‚       â”‚
â”‚ parent      â”‚ BIGINT      â”‚ YES     â”‚         â”‚         â”‚       â”‚
â”‚ descendants â”‚ BIGINT      â”‚ YES     â”‚         â”‚         â”‚       â”‚
â”‚ ranking     â”‚ BIGINT      â”‚ YES     â”‚         â”‚         â”‚       â”‚
â”‚ deleted     â”‚ BOOLEAN     â”‚ YES     â”‚         â”‚         â”‚       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 14 rows                                               6 columns â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âš«â—— select count(*) from hackernews;
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ count_star() â”‚
â”‚    int64     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      4155063 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âš«â—— select url from hackernews where url is not null limit 10;
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              url                                                               â”‚
â”‚                                                            varchar                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ https://www.reuters.com/technology/skorea-parliament-committee-votes-curb-google-apple-commission-dominance-2021-08-25/        â”‚
â”‚ https://builtin.com/blockchain/non-fungible-token-nft                                                                          â”‚
â”‚ https://www.freelancefalcon.com/                                                                                               â”‚
â”‚ https://www.theproductslice.com/p/how-to-launch-products                                                                       â”‚
â”‚ https://www.youtube.com/watch?v=RaeAhxmPodM                                                                                    â”‚
â”‚ https://secureitmania.medium.com/hackthebox-htb-walk-through-curling-d2d29753b92d                                              â”‚
â”‚ https://medium.com/techtofreedom/memory-management-in-python-3-popular-interview-questions-bce4bc69b69a                        â”‚
â”‚ https://www.amazon.science/blog/predicting-answers-to-product-questions-using-similar-products                                 â”‚
â”‚ https://spectrum.ieee.org/robotics/military-robots/to-protect-against-weaponized-drones-we-must-understand-their-key-strengths â”‚
â”‚ https://sveltemag.com/types-of-hair-accessories/                                                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            10 rows                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Run Time (s): real 0.003 user 0.009673 sys 0.001882


âš«â—— select split_part(url, '/', 3) as hld, url
from hackernews where url is not null limit 10;
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           hld            â”‚                                                              url                                                               â”‚
â”‚         varchar          â”‚                                                            varchar                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ www.reuters.com          â”‚ https://www.reuters.com/technology/skorea-parliament-committee-votes-curb-google-apple-commission-dominance-2021-08-25/        â”‚
â”‚ builtin.com              â”‚ https://builtin.com/blockchain/non-fungible-token-nft                                                                          â”‚
â”‚ www.freelancefalcon.com  â”‚ https://www.freelancefalcon.com/                                                                                               â”‚
â”‚ www.theproductslice.com  â”‚ https://www.theproductslice.com/p/how-to-launch-products                                                                       â”‚
â”‚ www.youtube.com          â”‚ https://www.youtube.com/watch?v=RaeAhxmPodM                                                                                    â”‚
â”‚ secureitmania.medium.com â”‚ https://secureitmania.medium.com/hackthebox-htb-walk-through-curling-d2d29753b92d                                              â”‚
â”‚ medium.com               â”‚ https://medium.com/techtofreedom/memory-management-in-python-3-popular-interview-questions-bce4bc69b69a                        â”‚
â”‚ www.amazon.science       â”‚ https://www.amazon.science/blog/predicting-answers-to-product-questions-using-similar-products                                 â”‚
â”‚ spectrum.ieee.org        â”‚ https://spectrum.ieee.org/robotics/military-robots/to-protect-against-weaponized-drones-we-must-understand-their-key-strengths â”‚
â”‚ sveltemag.com            â”‚ https://sveltemag.com/types-of-hair-accessories/                                                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 10 rows                                                                                                                                         2 columns â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Run Time (s): real 0.002 user 0.004766 sys 0.003104

â—— select split_part(url, '/', 3) as hld, count(*) as cnt
from hackernews
where url is not null 
group by all 
order by cnt desc limit 10;
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚         hld         â”‚  cnt  â”‚
â”‚       varchar       â”‚ int64 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ github.com          â”‚ 13620 â”‚
â”‚ www.youtube.com     â”‚ 12842 â”‚
â”‚ twitter.com         â”‚  6967 â”‚
â”‚ en.wikipedia.org    â”‚  6218 â”‚
â”‚ www.nytimes.com     â”‚  5647 â”‚
â”‚ medium.com          â”‚  4964 â”‚
â”‚ www.theguardian.com â”‚  4244 â”‚
â”‚ arstechnica.com     â”‚  3544 â”‚
â”‚ www.bloomberg.com   â”‚  3007 â”‚
â”‚ www.bbc.com         â”‚  2996 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 10 rows           2 columns â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Run Time (s): real 0.045 user 0.234648 sys 0.057366
```

## Extracting data

``` {.bash code-line-numbers="1|3|5"}
âš«â—— copy netflix to './output.tsv' (header, delimiter '\t'); â†©
Run Time (s): real 0.004 user 0.003130 sys 0.000854
âš«â—— copy netflix to './output.parquet' (format parquet); â†©
Run Time (s): real 0.015 user 0.012970 sys 0.002177
âš«â—— from read_parquet('./output.parquet') limit 3; â†©
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   As of    â”‚ Rank  â”‚ Year to Date Rank â”‚ Last Week Rank â”‚            Title             â”‚  Type   â”‚ Netflix Exclusive â”‚ Netflix Release Date â”‚ Days In Top 10 â”‚ Viewership Score â”‚
â”‚    date    â”‚ int64 â”‚      varchar      â”‚    varchar     â”‚           varchar            â”‚ varchar â”‚      varchar      â”‚       varchar        â”‚     int64      â”‚      int64       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2020-04-01 â”‚     1 â”‚ 1                 â”‚ 1              â”‚ Tiger King: Murder, Mayhem â€¦ â”‚ TV Show â”‚ Yes               â”‚ Mar 20, 2020         â”‚              9 â”‚               90 â”‚
â”‚ 2020-04-01 â”‚     2 â”‚ 2                 â”‚ -              â”‚ Ozark                        â”‚ TV Show â”‚ Yes               â”‚ Jul 21, 2017         â”‚              5 â”‚               45 â”‚
â”‚ 2020-04-01 â”‚     3 â”‚ 3                 â”‚ 2              â”‚ All American                 â”‚ TV Show â”‚                   â”‚ Mar 28, 2019         â”‚              9 â”‚               76 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

::: callout-note
The abbreviated SQL statement above is one of a number of SQL enhancements in DuckDB. See <https://duckdb.org/2023/08/23/even-friendlier-sql.htm>
:::

## Extracting data 2

``` {.bash code-line-numbers="1|2|3"}
âš«â—— .mode markdown â†©
âš«â—— .once output.md â†©
âš«â—— from netflix limit 10; â†©
```

``` {.bash code-line-numbers="1"}
bat output.md â†©
â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       â”‚ File: output.md
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1   â”‚ |   As of    | Rank | Year to Date Rank | Last Week Rank |            Title             |  Type   | Netflix Exclusive | Netflix Release Date | Days In Top 10 | Viewership Score |
   2   â”‚ |------------|------|-------------------|----------------|------------------------------|---------|-------------------|----------------------|----------------|------------------|
   3   â”‚ | 2020-04-01 | 1    | 1                 | 1              | Tiger King: Murder, Mayhem â€¦ | TV Show | Yes               | Mar 20, 2020         | 9              | 90               |
   4   â”‚ | 2020-04-01 | 2    | 2                 | -              | Ozark                        | TV Show | Yes               | Jul 21, 2017         | 5              | 45               |
   5   â”‚ | 2020-04-01 | 3    | 3                 | 2              | All American                 | TV Show |                   | Mar 28, 2019         | 9              | 76               |
   6   â”‚ | 2020-04-01 | 4    | 4                 | -              | Blood Father                 | Movie   |                   | Mar 26, 2020         | 5              | 30               |
   7   â”‚ | 2020-04-01 | 5    | 5                 | 4              | The Platform                 | Movie   | Yes               | Mar 20, 2020         | 9              | 55               |
   8   â”‚ | 2020-04-01 | 6    | 6                 | -              | Car Masters: Rust to Riches  | TV Show | Yes               | Sep 14, 2018         | 4              | 14               |
   9   â”‚ | 2020-04-01 | 7    | 10                | -              | Unorthodox                   | TV Show | Yes               | Mar 26, 2020         | 2              | 5                |
  10   â”‚ | 2020-04-01 | 8    | 7                 | 5              | Love is Blind                | TV Show | Yes               | Feb 13, 2020         | 9              | 40               |
  11   â”‚ | 2020-04-01 | 9    | 8                 | -              | Badland                      | Movie   |                   | Mar 26, 2020         | 4              | 11               |
  12   â”‚ | 2020-04-01 | 10   | 9                 | -              | Uncorked                     | Movie   | Yes               | Mar 27, 2020         | 4              | 15               |
```

## DuckDB Extensions

``` bash
âš«â—— select extension_name, description from duckdb_extensions(); â†©
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  extension_name  â”‚                                    description                                     â”‚
â”‚     varchar      â”‚                                      varchar                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ arrow            â”‚ A zero-copy data integration between Apache Arrow and DuckDB                       â”‚
â”‚ autocomplete     â”‚ Adds support for autocomplete in the shell                                         â”‚
â”‚ aws              â”‚ Provides features that depend on the AWS SDK                                       â”‚
â”‚ azure            â”‚ Adds a filesystem abstraction for Azure blob storage to DuckDB                     â”‚
â”‚ excel            â”‚ Adds support for Excel-like format strings                                         â”‚
â”‚ fts              â”‚ Adds support for Full-Text Search Indexes                                          â”‚
â”‚ httpfs           â”‚ Adds support for reading and writing files over a HTTP(S) connection               â”‚
â”‚ iceberg          â”‚ Adds support for Apache Iceberg                                                    â”‚
â”‚ icu              â”‚ Adds support for time zones and collations using the ICU library                   â”‚
â”‚ inet             â”‚ Adds support for IP-related data types and functions                               â”‚
â”‚ jemalloc         â”‚ Overwrites system allocator with JEMalloc                                          â”‚
â”‚ json             â”‚ Adds support for JSON operations                                                   â”‚
â”‚ motherduck       â”‚ Enables motherduck integration with the system                                     â”‚
â”‚ mysql_scanner    â”‚ Adds support for connecting to a MySQL database                                    â”‚
â”‚ parquet          â”‚ Adds support for reading and writing parquet files                                 â”‚
â”‚ postgres_scanner â”‚ Adds support for connecting to a Postgres database                                 â”‚
â”‚ shell            â”‚                                                                                    â”‚
â”‚ spatial          â”‚ Geospatial extension that adds support for working with spatial data and functions â”‚
â”‚ sqlite_scanner   â”‚ Adds support for reading and writing SQLite database files                         â”‚
â”‚ substrait        â”‚ Adds support for the Substrait integration                                         â”‚
â”‚ tpcds            â”‚ Adds TPC-DS data generation and query support                                      â”‚
â”‚ tpch             â”‚ Adds TPC-H data generation and query support                                       â”‚
â”‚ visualizer       â”‚ Creates an HTML-based visualization of the query plan                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
```

## Extension Demo - httpfs

``` {.bash code-line-numbers="1|12"}
âš«â—— select extension_name, loaded, installed from duckdb_extensions(); â†©
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  extension_name  â”‚ loaded  â”‚ installed â”‚
â”‚     varchar      â”‚ boolean â”‚  boolean  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ arrow            â”‚ false   â”‚ true      â”‚
â”‚ autocomplete     â”‚ true    â”‚ true      â”‚
â”‚ aws              â”‚ false   â”‚ false     â”‚
â”‚ azure            â”‚ false   â”‚ false     â”‚
â”‚ excel            â”‚ false   â”‚ false     â”‚
â”‚ fts              â”‚ false   â”‚ false     â”‚
â”‚ httpfs           â”‚ false   â”‚ true      â”‚
â”‚ iceberg          â”‚ false   â”‚ false     â”‚
â”‚ icu              â”‚ true    â”‚ true      â”‚
...
```

## Extension Demo - parquet metadata

``` {.bash code-line-numbers="1|2-3|23-25"}
âš«â—— load httpfs;
âš«â—— select file_name, name, type  
   from parquet_schema('https://raw.githubusercontent.com/tobilg/aws-edge-locations/main/data/aws-edge-locations.parquet'); â†©
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                            file_name                                             â”‚     name      â”‚    type    â”‚
â”‚                                             varchar                                              â”‚    varchar    â”‚  varchar   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ https://raw.githubusercontent.com/tobilg/aws-edge-locations/main/data/aws-edge-locations.parquet â”‚ root          â”‚            â”‚
â”‚ https://raw.githubusercontent.com/tobilg/aws-edge-locations/main/data/aws-edge-locations.parquet â”‚ code          â”‚ BYTE_ARRAY â”‚
â”‚ https://raw.githubusercontent.com/tobilg/aws-edge-locations/main/data/aws-edge-locations.parquet â”‚ city          â”‚ BYTE_ARRAY â”‚
â”‚ https://raw.githubusercontent.com/tobilg/aws-edge-locations/main/data/aws-edge-locations.parquet â”‚ state         â”‚ BYTE_ARRAY â”‚
â”‚ https://raw.githubusercontent.com/tobilg/aws-edge-locations/main/data/aws-edge-locations.parquet â”‚ country       â”‚ BYTE_ARRAY â”‚
â”‚ https://raw.githubusercontent.com/tobilg/aws-edge-locations/main/data/aws-edge-locations.parquet â”‚ countryCode   â”‚ BYTE_ARRAY â”‚
â”‚ https://raw.githubusercontent.com/tobilg/aws-edge-locations/main/data/aws-edge-locations.parquet â”‚ count         â”‚ INT64      â”‚
â”‚ https://raw.githubusercontent.com/tobilg/aws-edge-locations/main/data/aws-edge-locations.parquet â”‚ latitude      â”‚ DOUBLE     â”‚
â”‚ https://raw.githubusercontent.com/tobilg/aws-edge-locations/main/data/aws-edge-locations.parquet â”‚ longitude     â”‚ DOUBLE     â”‚
â”‚ https://raw.githubusercontent.com/tobilg/aws-edge-locations/main/data/aws-edge-locations.parquet â”‚ region        â”‚ BYTE_ARRAY â”‚
â”‚ https://raw.githubusercontent.com/tobilg/aws-edge-locations/main/data/aws-edge-locations.parquet â”‚ pricingRegion â”‚ BYTE_ARRAY â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 11 rows                                                                                                             3 columns â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âš«â—— SELECT code, city, state
    FROM 'https://raw.githubusercontent.com/tobilg/aws-edge-locations/main/data/aws-edge-locations.parquet'
    limit 5; â†©
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  code   â”‚    city     â”‚        state         â”‚
â”‚ varchar â”‚   varchar   â”‚       varchar        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ IAD     â”‚ Washington  â”‚ District of Columbia â”‚
â”‚ ORD     â”‚ Chicago     â”‚ Illinois             â”‚
â”‚ JFK     â”‚ New York    â”‚ New York             â”‚
â”‚ ATL     â”‚ Atlanta     â”‚ Georgia              â”‚
â”‚ LAX     â”‚ Los Angeles â”‚ California           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Run Time (s): real 0.960 user 0.010294 sys 0.003753
```

# Programmable DuckDB

## Client APIs

::: incremental
-   C / C++ / Java
-   Go\
-   Node.js
-   Python / R / Julia
-   Rust
-   Swift
-   Wasm
-   ADBC / ODBC
:::

## Python API

Installed via pip

`pip install duckdb`

``` {.python code-line-numbers="1-3|5|7|10|19-22|34-37|39|47-51"}
In [3]: import duckdb

In [4]: import pandas as pd

In [5]: pdf = pd.read_csv('./netflix_daily_top_10.csv', index_col=None)

In [6]: type(pdf)
Out[6]: pandas.core.frame.DataFrame

In [7]: pdf.head()
Out[7]:
        As of  Rank Year to Date Rank Last Week Rank                         Title     Type Netflix Exclusive Netflix Release Date  Days In Top 10  Viewership Score
0  2020-04-01     1                 1              1  Tiger King: Murder, Mayhem â€¦  TV Show               Yes         Mar 20, 2020               9                90
1  2020-04-01     2                 2              -                         Ozark  TV Show               Yes         Jul 21, 2017               5                45
2  2020-04-01     3                 3              2                  All American  TV Show               NaN         Mar 28, 2019               9                76
3  2020-04-01     4                 4              -                  Blood Father    Movie               NaN         Mar 26, 2020               5                30
4  2020-04-01     5                 5              4                  The Platform    Movie               Yes         Mar 20, 2020               9                55

In [8]: duckdb.sql("""select type, count(*) cnt 
                      from pdf 
                      group by all
                      order by cnt desc""" )
Out[8]:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Type       â”‚  cnt  â”‚
â”‚     varchar     â”‚ int64 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TV Show         â”‚  4446 â”‚
â”‚ Movie           â”‚  2611 â”‚
â”‚ Stand-Up Comedy â”‚    41 â”‚
â”‚ Concert/Perfâ€¦   â”‚     2 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜

In [9]: sum_df = duckdb.sql("""select type, count(*) cnt 
                               from pdf 
                               group by all 
                               order by cnt desc""").df()

In [10]: sum_df
Out[10]:
              Type   cnt
0          TV Show  4446
1            Movie  2611
2  Stand-Up Comedy    41
3    Concert/Perfâ€¦     2

In [7]: (pdf.query('Type != ""')
   ...: .groupby("Type")
   ...: .size()
   ...: .reset_index(name="cnt")
   ...: .sort_values("cnt", ascending=False))
Out[7]:
              Type   cnt
3          TV Show  4446
1            Movie  2611
2  Stand-Up Comedy    41
0    Concert/Perfâ€¦     2
```

## Python Relational API

``` {.python code-line-numbers="2|4-8|10-17"}

In [23]: nf = con.sql("select title from netflix")

In [24]: (
    ...:     nf.aggregate("title, count(*) as cnt")
    ...:     .order("cnt desc")
    ...:     .limit(4)
    ...: )
Out[23]:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Title   â”‚  cnt  â”‚
â”‚  varchar  â”‚ int64 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Cocomelon â”‚   428 â”‚
â”‚ Ozark     â”‚    85 â”‚
â”‚ Cobra Kai â”‚    81 â”‚
â”‚ Manifest  â”‚    80 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Python Function API

The function API allows the extension of DuckDB with Python User Defined Functions.

``` {.python code-line-numbers="2-5|6-8|11|14"}

In [1]: import duckdb
   ...: from duckdb.typing import *
   ...: from faker import Faker
   ...:
   ...: def generate_random_name():
   ...:     fake = Faker()
   ...:     return fake.name()
   ...:

In [2]: duckdb.create_function("random_name", generate_random_name, [], VARCHAR, side_effects=True)
Out[2]: <duckdb.duckdb.DuckDBPyConnection at 0x1045e5130>

In [3]: duckdb.sql("select random_name(), * from range(3)")
Out[3]:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚  random_name()  â”‚ range â”‚
â”‚     varchar     â”‚ int64 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Anna Baxter     â”‚     0 â”‚
â”‚ Roberto Charles â”‚     1 â”‚
â”‚ Andrea Mueller  â”‚     2 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

# Wrap-up ![](https://duckdb.org/images/blog/bird-dance.gif)

## Resources

-   [duckdb.org](https://duckdb.org){preview-link="true"} - documentation
-   [motherduck.com](https://motherduck.com){preview-link="true"} - DuckDB cloud / serverless
-   [harlequin.sh](https://harlequin.sh/){preview-link="true"} - a TUI for DuckDB
-   [github.com/davidgasquez/awesome-duckdb](https://github.com/davidgasquez/awesome-duckdb){preview-link="true"} - list of DuckDB resources
-   [github.com/duckdb/duckdb](https://github.com/duckdb/duckdb){preview-link="true"} - DuckDB github
-   [db-engines.com/en/ranking/relational+dbms](https://db-engines.com/en/ranking/relational+dbms){preview-link="true"} - Database rankings

#

![](i_use_vim.jpeg)

